{"ast":null,"code":"var express = require('express');\n\nvar router = express.Router();\nvar CLIENT_ID = process.env.CLIENT_ID;\nvar CLIENT_SECRET = process.env.CLIENT_SECRET;\nvar redirect = encodeURIComponent('http://localhost:19006/auth/redirect');\nrouter.get('/login', function (req, res) {\n  res.redirect(\"https://discordapp.com/api/oauth2/authorize?client_id=\" + CLIENT_ID + \"&scope=identify&response_type=code&redirect_uri=\" + redirect);\n});\nmodule.exports = router;","map":{"version":3,"sources":["D:/GitKraken/Sloth/App/Routes/Discord.js"],"names":["express","require","router","Router","CLIENT_ID","process","env","CLIENT_SECRET","redirect","encodeURIComponent","get","req","res","module","exports"],"mappings":"AAyCA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AAEA,IAAMC,MAAM,GAAGF,OAAO,CAACG,MAAR,EAAf;AAEA,IAAMC,SAAS,GAAGC,OAAO,CAACC,GAAR,CAAYF,SAA9B;AACA,IAAMG,aAAa,GAAGF,OAAO,CAACC,GAAR,CAAYC,aAAlC;AACA,IAAMC,QAAQ,GAAGC,kBAAkB,CAAC,sCAAD,CAAnC;AAEAP,MAAM,CAACQ,GAAP,CAAW,QAAX,EAAqB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACjCA,EAAAA,GAAG,CAACJ,QAAJ,4DAAsEJ,SAAtE,wDAAkII,QAAlI;AACD,CAFD;AAIAK,MAAM,CAACC,OAAP,GAAiBZ,MAAjB","sourcesContent":["/* const express = require('express');\r\nconst dotenv = require('dotenv').config()\r\nconst fetch = require('node-fetch');\r\nconst btoa = require('btoa');\r\nconst { catchAsync } = require('../utils');\r\nconst { URLSearchParams } = require('url'); // can also use form-data\r\nconst axios = require('axios');\r\nconst path = require('path');\r\nconst bodyParser = require('body-parser');\r\nconst fetch = require('node-fetch');\r\n\r\nconst router = express.Router();\r\nconst scopes = ['identify', 'guilds'];\r\n\r\nconst CLIENT_ID = process.env.CLIENT_ID;\r\nconst CLIENT_SECRET = process.env.CLIENT_SECRET;\r\nconst redirect =       \r\nencodeURIComponent('http://localhost:50451/api/discord/callback');\r\n\r\nrouter.get('/login', (req, res) => {\r\n  res.redirect(`https://discordapp.com/api/oauth2/authorize?client_id=${CLIENT_ID}&redirect_uri=${redirect}&response_type=code&scope=identify%20guilds`);\r\n});\r\n\r\nrouter.get('/callback', catchAsync(async (req, res) => {\r\n  if (!req.query.code) throw new Error('NoCodeProvided');\r\n  const code = req.query.code;\r\n  const creds = btoa(`${CLIENT_ID}:${CLIENT_SECRET}`);\r\n  const response = await fetch(`https://discordapp.com/api/oauth2/token?grant_type=authorization_code&code=${code}&redirect_uri=${redirect}`,\r\n    {\r\n  method: 'POST',\r\n  headers: {\r\n    Authorization: `Basic ${creds}`,\r\n  },\r\n});\r\n  const json = await response.json();\r\n  res.redirect(`/success/?token=${json.access_token}`);\r\n}));\r\n\r\nmodule.exports = router; */\r\n\r\n///outro tutorial\r\nconst express = require('express');\r\n\r\nconst router = express.Router();\r\n\r\nconst CLIENT_ID = process.env.CLIENT_ID;\r\nconst CLIENT_SECRET = process.env.CLIENT_SECRET;\r\nconst redirect = encodeURIComponent('http://localhost:19006/auth/redirect');//('http://localhost:19006/api/discord/callback');//50451\r\n\r\nrouter.get('/login', (req, res) => {\r\n  res.redirect(`https://discordapp.com/api/oauth2/authorize?client_id=${CLIENT_ID}&scope=identify&response_type=code&redirect_uri=${redirect}`);\r\n});\r\n\r\nmodule.exports = router;  \r\n"]},"metadata":{},"sourceType":"script"}